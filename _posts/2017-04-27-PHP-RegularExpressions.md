---
layout: post
title: 'PHP 正则表达式'
date: '2017-04-27'
header-img: "img/post-bg-unix.jpg"
tags:
     - PHP
author: 'Bro Qiang'
---

## PHP 正则表达式

> PHP 有两个正则表达式的扩展, PCRE 和 POSIX 
> 
> 不过从PHP5.3.0开始 POSIX 扩展不再建议使用，所有调用 POSIX 扩展中函数都将提示E_DEPRECATED 错误
> 
> 而且一般使用的也都是 PCRE 扩展的正则,所以只需要学习 PCRE 即可

## PCRE 正则语法

PCRE 扩展使用的模式语法非常类似 perl ,表达式必须用分隔符闭合，比如一个正斜杠(/) 

分隔符可以使任意非字母数字,除反斜杠(\)和空字节之外的非空白 ascii 字符.如果分隔符 在表达式中使用,需要使用反斜线进行转义

详见 [官方文档](http://php.net/manual/zh/reference.pcre.pattern.syntax.php)

官方也是基本的使用, 要想把正则玩精通, 还是需要找专门的正则书籍, 语法基本都是通用的, 比如 <精通正则表达式> 这本书


## Pattern Syntax (模式语法)

正则表达式是一个从左到右匹配目标字符串的模式,大多数字符自身就代表一个匹配 它们自身的模式

### [分隔符](http://php.net/manual/zh/regexp.reference.delimiters.php)


当使用 PCRE 函数的时候,模式需要由分隔符闭合包裹,分隔符可以使任意非字母数字,非反斜线,非空白字符

经常使用的分隔符是 `/` `#` `~`

示例:

```
/foo bar/
#^[^0-9]$#
+php+
%[a-zA-Z0-9_-]%
```

如果分隔符需要在模式内进行匹配，它必须使用反斜线进行转义

如果分隔符经常在模式内出现,一个更好的选择就是是用其他分隔符来提高可读性

示例:

```
/http:\/\//
#http://#
```

可以在结束分隔符后面增加模式修饰符, [包括 (不仅仅)](http://php.net/manual/zh/reference.pcre.pattern.modifiers.php) :

- `i` -- 模式中不区分大小写

- `s` -- 模式中的点号元字符匹配所有字符，包含换行符

- `x` -- 模式中的没有经过转义的或不在字符类中的空白数据字符总会被忽略， 并且位于一个未转义的字符类外部的#字符和下一个换行符之间的字符也被忽略

- `D` -- 模式中的元字符美元符号仅仅匹配目标字符串的末尾

- `u` -- 模式和目标字符串都被认为是 utf-8 的

最常用的,就是下面这样

```
/[a-z]/iu
```


### 元字符

一些字符被赋予特殊的涵义,使其不再单纯的代表自己,模式中的这种有特殊涵义的编码字符称为元字符

共有两种不同的元字符,一种是可以在模式中方括号外任何地方使用的，另外一种 是需要在方括号内使用的:

- `\` -- 一般用于转义字符, [方括号内也是转移字符]

- `^` -- 目标的开始位置(或在多行模式下是行首), [在[]内时表示取反]

- `$` -- 目标的结束位置(或在多行模式下是行尾)

- `.` -- 匹配除换行符外的任何字符(默认)

- `[]` -- 里面定义字符, 如 `[a-z]`

- `|` -- 可选分支(或的意思)

- `()` -- 用来分组

- `?` -- 匹配0个或1个字符,等价于 {0,1}

- `*` -- 匹配0或多个字符,等价于 {0,}

- `+` -- 匹配1个或多个,等价于 {1,}

- `{}` -- 自定义数量, 如 `[a-z]{1,5}`

- `-` -- [定义范围时中间的分隔符, 如 `[a-z]`,只可用在方括号内]

### Escape sequences (转译序列)

这个转义序列我没理解字面意思, 应该就是说代表一系列吧, 此处就是指的用 `\` + `指定的字符` 代表字符的组合

下面只列出 PHP 常用,不止这些, 需要的时候可以再查

- `\n` -- 换行符

- `\r` -- 回车

- `\t` 或 `\011` -- 水平制表符, 一般代表键盘的 Tab 键

- `\040` -- 空格的另外一种用法,ASCII码值等于8进制040数的字符，即空格字符

- `\d` -- 任意十进制数字

- `\D` -- 任意非十进制数字

- `\s` -- 任意空白字符

- `\S` -- 任意非空白字符

- `\h` -- 任意水平空白字符, 一般是 空格和tab

- `\H` -- 任意非水平空白字符

- `\v` -- 任意垂直空白字符, 一般是 回车符,换行符,进纸符,垂直制表符,Unicode的行分隔符和段分隔符

- `\V` -- 任意非垂直空白字符

- `\w` -- 任意单词字符, 代表任意字母、数字、下划线

- `\W` -- 任意非单词字符


### PCRE 函数

见 [函数索引](http://broqiang.com/2017/04/16/PHP-FunctionIndex/#pcre-%E5%87%BD%E6%95%B0-%E6%AD%A3%E5%88%99) 文档


### 常用正则

见 [常用正则](http://broqiang.com/2017/04/27/PHP-CommonRegular) 文档

